.masonryGrid {
    display: grid;
    /*
      Responsive columns with a hard cap of 3.
      - Start with 3 columns when space allows.
      - Drop to 2 and then 1 only when space is insufficient.
    */
    --card-min: 340px;            /* minimum width for each column */
    --gap: clamp(1rem, 2vw, 2rem); /* healthy gap to prevent rotated overlap */
    gap: var(--gap);
    padding: clamp(0.75rem, 2vw, 1.5rem);
    margin: 0 auto;
    align-items: start;

    /* default to three columns; switch to 2/1 via media queries below */
    grid-template-columns: repeat(3, minmax(0, 1fr));

    /* Performance optimization: skip off-screen rendering */
    content-visibility: auto;
    contain-intrinsic-size: 900px; /* prevents layout shift when unseen */
}

.masonryItem {
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Prevent vertical stretching */
    width: 100%;
    margin-bottom: 0.5rem;
    padding: 0.25rem; /* buffer so rotated items don't touch neighbors */
    break-inside: avoid; /* Prevent items from breaking across columns */
    will-change: transform;
}

/* Add a slight random rotation to each item for the post-it note feel */
.masonryItem:nth-child(5n+1) { transform: rotate(1.5deg); }
.masonryItem:nth-child(5n+2) { transform: rotate(-1deg); }
.masonryItem:nth-child(5n+3) { transform: rotate(0.5deg); }
.masonryItem:nth-child(5n+4) { transform: rotate(-1.5deg); }
.masonryItem:nth-child(5n+5) { transform: rotate(1deg); }


.embedContainer {
    width: 100%;
    max-width: 540px; /* Constrain to Instagram's max embed width */
    display: flex;
    justify-content: center;
    padding-bottom: 0.2rem; /* consistent bottom space */
    border-radius: 12px;
    overflow: hidden;
    background: linear-gradient(to right, #4f46e5, #f5e882); /* placeholder background */
    box-shadow: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
    opacity: 0; /* Initially hidden */
    transition: opacity 0.5s ease-in-out; /* Smooth transition */

    /* Ensure card never collapses before lazy content loads */
    min-height: 360px;
}

.embedContainer.loaded {
    opacity: 1; /* Fade in when loaded */
}

.embedContainer > div {
    width: 100%;
    display: flex;
    justify-content: center;
}

/*
  Prevent right-side cropping: IG embed sets a min-width inline.
  Override it so cards can shrink fluidly all the way down to 1 column.
*/
.embedContainer > div > blockquote {
    min-width: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
}

/*
  Drop from 3 columns -> 2 when container can't fit 3 columns at --card-min.
  Approx threshold: 3 * 340px + 2 * gap â‰ˆ ~1100px (incl. padding).
*/
@media (max-width: 1120px) {
    .masonryGrid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }
}

/*
  Drop from 2 columns -> 1 when space is tighter than ~720px.
*/
@media (max-width: 760px) {
    .masonryGrid {
        grid-template-columns: 1fr;
        padding-left: clamp(0.5rem, 2vw, 0.75rem);
        padding-right: clamp(0.5rem, 2vw, 0.75rem);
    }
}

/* Ensure Instagram iframes are responsive at all widths */
.embedContainer iframe {
    max-width: 100% !important;
    width: 100% !important;
}
